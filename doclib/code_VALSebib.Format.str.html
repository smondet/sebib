<html><head>
<link rel="stylesheet" href="style.css" type="text/css">
<meta content="text/html; charset=iso-8859-1" http-equiv="Content-Type">
<link rel="Start" href="index.html">
<link title="Index of types" rel=Appendix href="index_types.html">
<link title="Index of exceptions" rel=Appendix href="index_exceptions.html">
<link title="Index of values" rel=Appendix href="index_values.html">
<link title="Index of modules" rel=Appendix href="index_modules.html">
<link title="Sebib" rel="Chapter" href="Sebib.html"><title>Sebib Library : Sebib.Format.str</title>
</head>
<body>
<code class="code"><span class="keyword">let</span>&nbsp;str&nbsp;~pattern&nbsp;?(transform_text:text_transformation=&nbsp;<span class="keywordsign">`</span>no)&nbsp;(set:<span class="constructor">Biblio</span>.set)&nbsp;=<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;rex_field&nbsp;=&nbsp;<span class="constructor">Pcre</span>.regexp&nbsp;<span class="string">"@\\{[^\\}]+\\}"</span>&nbsp;<span class="keyword">in</span><br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;strfield&nbsp;?authors_style&nbsp;?title_style&nbsp;f&nbsp;e&nbsp;=<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;str&nbsp;=&nbsp;<span class="constructor">Biblio</span>.field_or_empty&nbsp;?authors_style&nbsp;?title_style&nbsp;f&nbsp;e&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;do_sanitization&nbsp;transform_text&nbsp;str&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;sub_eq&nbsp;s&nbsp;i&nbsp;o&nbsp;m&nbsp;=<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="constructor">String</span>.length&nbsp;s&nbsp;&lt;&nbsp;o&nbsp;+&nbsp;i&nbsp;<span class="keyword">then</span>&nbsp;<span class="keyword">false</span>&nbsp;<span class="keyword">else</span>&nbsp;(<span class="constructor">String</span>.sub&nbsp;s&nbsp;i&nbsp;o&nbsp;=$=&nbsp;m)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;is_write&nbsp;stack&nbsp;=<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Stack</span>.is_empty&nbsp;stack&nbsp;<span class="keywordsign">||</span>&nbsp;<span class="constructor">Stack</span>.top&nbsp;stack&nbsp;=@=&nbsp;<span class="keywordsign">`</span>write&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;subs&nbsp;stack&nbsp;entry&nbsp;=&nbsp;<span class="keyword">function</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="string">"@{id}"</span>&nbsp;<span class="keyword">when</span>&nbsp;is_write&nbsp;stack&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;&nbsp;strfield&nbsp;<span class="keywordsign">`</span>id&nbsp;entry<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="string">"@{authors}"</span>&nbsp;<span class="keyword">when</span>&nbsp;is_write&nbsp;stack&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;strfield&nbsp;<span class="keywordsign">`</span>authors&nbsp;entry<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="string">"@{authors-and}"</span>&nbsp;<span class="keyword">when</span>&nbsp;is_write&nbsp;stack&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strfield&nbsp;~authors_style:<span class="keywordsign">`</span>comas_and&nbsp;<span class="keywordsign">`</span>authors&nbsp;entry&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="string">"@{authors-bibtex}"</span>&nbsp;<span class="keyword">when</span>&nbsp;is_write&nbsp;stack&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strfield&nbsp;~authors_style:<span class="keywordsign">`</span>bibtex&nbsp;<span class="keywordsign">`</span>authors&nbsp;entry&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="string">"@{authors-acm}"</span>&nbsp;<span class="keyword">when</span>&nbsp;is_write&nbsp;stack&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strfield&nbsp;~authors_style:<span class="keywordsign">`</span>acm&nbsp;<span class="keywordsign">`</span>authors&nbsp;entry&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="string">"@{authors-etal}"</span>&nbsp;<span class="keyword">when</span>&nbsp;is_write&nbsp;stack&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strfield&nbsp;~authors_style:<span class="keywordsign">`</span>et_al&nbsp;<span class="keywordsign">`</span>authors&nbsp;entry&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="string">"@{title}"</span>&nbsp;<span class="keyword">when</span>&nbsp;is_write&nbsp;stack&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;strfield&nbsp;<span class="keywordsign">`</span>title&nbsp;entry&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="string">"@{title-punct}"</span>&nbsp;<span class="keyword">when</span>&nbsp;is_write&nbsp;stack&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strfield&nbsp;~title_style:<span class="keywordsign">`</span>punct&nbsp;<span class="keywordsign">`</span>title&nbsp;entry&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="string">"@{how}"</span>&nbsp;<span class="keyword">when</span>&nbsp;is_write&nbsp;stack&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;strfield&nbsp;<span class="keywordsign">`</span>how&nbsp;entry&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="string">"@{year}"</span>&nbsp;<span class="keyword">when</span>&nbsp;is_write&nbsp;stack&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;strfield&nbsp;<span class="keywordsign">`</span>year&nbsp;entry&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="string">"@{url}"</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">when</span>&nbsp;is_write&nbsp;stack&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;strfield&nbsp;<span class="keywordsign">`</span>url&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;entry&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="string">"@{pdfurl}"</span>&nbsp;&nbsp;&nbsp;<span class="keyword">when</span>&nbsp;is_write&nbsp;stack&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;strfield&nbsp;<span class="keywordsign">`</span>pdfurl&nbsp;&nbsp;&nbsp;&nbsp;entry&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="string">"@{comment}"</span>&nbsp;<span class="keyword">when</span>&nbsp;is_write&nbsp;stack&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strfield&nbsp;(<span class="keywordsign">`</span>comment&nbsp;<span class="string">"main"</span>)&nbsp;entry<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;s&nbsp;<span class="keyword">when</span>&nbsp;sub_eq&nbsp;s&nbsp;0&nbsp;10&nbsp;<span class="string">"@{comment-"</span>&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;lgth&nbsp;=&nbsp;<span class="constructor">Str</span>.length&nbsp;s&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;opt&nbsp;=&nbsp;(<span class="constructor">Str</span>.sub&nbsp;s&nbsp;10&nbsp;(lgth&nbsp;-&nbsp;11))&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strfield&nbsp;(<span class="keywordsign">`</span>comment&nbsp;opt)&nbsp;entry<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="string">"@{bibtex}"</span>&nbsp;&nbsp;&nbsp;<span class="keyword">when</span>&nbsp;is_write&nbsp;stack&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">BibTeX</span>.format_entry&nbsp;entry&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="string">"@{abstract}"</span>&nbsp;<span class="keyword">when</span>&nbsp;is_write&nbsp;stack&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;strfield&nbsp;<span class="keywordsign">`</span>abstract&nbsp;&nbsp;entry&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="string">"@{doi}"</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">when</span>&nbsp;is_write&nbsp;stack&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;strfield&nbsp;<span class="keywordsign">`</span>doi&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;entry&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="string">"@{citation}"</span>&nbsp;<span class="keyword">when</span>&nbsp;is_write&nbsp;stack&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;strfield&nbsp;<span class="keywordsign">`</span>citation&nbsp;&nbsp;entry&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="string">"@{tags}"</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">when</span>&nbsp;is_write&nbsp;stack&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;strfield&nbsp;<span class="keywordsign">`</span>tags&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;entry&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="string">"@{keywords}"</span>&nbsp;<span class="keyword">when</span>&nbsp;is_write&nbsp;stack&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;strfield&nbsp;<span class="keywordsign">`</span>keywords&nbsp;&nbsp;entry&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="string">"@{@}"</span>&nbsp;<span class="keyword">when</span>&nbsp;is_write&nbsp;stack&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="string">"@"</span>&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="string">"@{n}"</span>&nbsp;<span class="keyword">when</span>&nbsp;is_write&nbsp;stack&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="string">"\n"</span>&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;s&nbsp;<span class="keyword">when</span>&nbsp;sub_eq&nbsp;s&nbsp;0&nbsp;4&nbsp;<span class="string">"@{if"</span>&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;lgth&nbsp;=&nbsp;<span class="constructor">String</span>.length&nbsp;s&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;expr&nbsp;=&nbsp;<span class="constructor">Request</span>.of_string&nbsp;(<span class="constructor">String</span>.sub&nbsp;s&nbsp;4&nbsp;(lgth&nbsp;-&nbsp;5))&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span>&nbsp;<span class="keyword">match</span>&nbsp;is_write&nbsp;stack,&nbsp;<span class="constructor">Request</span>.is_ok&nbsp;entry&nbsp;expr&nbsp;<span class="keyword">with</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="keyword">true</span>,&nbsp;<span class="keyword">true</span>&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">Stack</span>.push&nbsp;<span class="keywordsign">`</span>write&nbsp;stack<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="keyword">true</span>,&nbsp;<span class="keyword">false</span>&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">Stack</span>.push&nbsp;<span class="keywordsign">`</span>no_write&nbsp;stack<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="keyword">false</span>,&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">Stack</span>.push&nbsp;<span class="keywordsign">`</span>silent&nbsp;stack<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">""</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="string">"@{else}"</span>&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span>&nbsp;<span class="keyword">try</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">match</span>&nbsp;<span class="constructor">Stack</span>.pop&nbsp;stack&nbsp;<span class="keyword">with</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="keywordsign">`</span>write&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">Stack</span>.push&nbsp;<span class="keywordsign">`</span>no_write&nbsp;stack;&nbsp;<span class="string">""</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="keywordsign">`</span>no_write&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">Stack</span>.push&nbsp;<span class="keywordsign">`</span>write&nbsp;stack;&nbsp;<span class="string">""</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="keywordsign">`</span>silent&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">Stack</span>.push&nbsp;<span class="keywordsign">`</span>silent&nbsp;stack&nbsp;;&nbsp;<span class="string">""</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">with</span>&nbsp;e&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;failwith&nbsp;<span class="string">"@{else}&nbsp;does&nbsp;not&nbsp;match&nbsp;any&nbsp;@{if&nbsp;...}"</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="string">"@{endif}"</span>&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span>&nbsp;<span class="keyword">try</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;_&nbsp;=&nbsp;&nbsp;<span class="constructor">Stack</span>.pop&nbsp;stack&nbsp;<span class="keyword">in</span>&nbsp;<span class="string">""</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">with</span>&nbsp;e&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;failwith&nbsp;<span class="string">"@{endif}&nbsp;does&nbsp;not&nbsp;match&nbsp;any&nbsp;@{if&nbsp;...}"</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;s&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="keyword">if</span>&nbsp;is_write&nbsp;stack&nbsp;<span class="keyword">then</span>&nbsp;s&nbsp;<span class="keyword">else</span>&nbsp;<span class="string">""</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">String</span>.concat&nbsp;<span class="string">""</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="constructor">Ls</span>.concat&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="constructor">Ls</span>.map<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="keyword">fun</span>&nbsp;entry&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;stack&nbsp;=&nbsp;<span class="constructor">Stack</span>.create&nbsp;()&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Ls</span>.map&nbsp;(<span class="keyword">function</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Pcre</span>.<span class="constructor">Text</span>&nbsp;t&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="keyword">if</span>&nbsp;is_write&nbsp;stack&nbsp;<span class="keyword">then</span>&nbsp;t&nbsp;<span class="keyword">else</span>&nbsp;<span class="string">""</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Pcre</span>.<span class="constructor">Delim</span>&nbsp;s&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;subs&nbsp;stack&nbsp;entry&nbsp;s<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="string">""</span>)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="constructor">Pcre</span>.full_split&nbsp;~rex:rex_field&nbsp;pattern))&nbsp;set))</code></body></html>